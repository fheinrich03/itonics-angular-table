<section class="min-w-0 py-4 sm:py-6">
    <div class="flex flex-col gap-4 sm:gap-6 lg:grid lg:grid-cols-[220px_1fr_360px] lg:items-start lg:gap-8">
        <div
            class="border-border/60 bg-background/40 shrink-0 rounded-lg border p-2 sm:p-3 lg:mt-1"
            aria-hidden="true"
        >
            <img
                src="/images/milenium-falcon.png"
                alt=""
                class="mx-auto block h-auto w-full max-w-[140px] drop-shadow-2xl sm:max-w-[200px] lg:max-w-[220px]"
                loading="eager"
                decoding="async"
            />
        </div>

        <div class="min-w-0 self-center">
            <h1 class="mt-0 text-2xl font-bold tracking-tight sm:mt-2 sm:text-3xl lg:text-4xl">
                Starships
            </h1>
            <p class="text-muted-foreground mt-1 max-w-2xl text-sm sm:mt-2 sm:text-base">
                Search, sort and infinite-scroll through starships from the Star Wars universe.
            </p>
        </div>

        <div hlmCard size="sm" class="w-full self-end lg:w-[360px]">
            <div hlmCardHeader>
                <h2 hlmCardTitle>Fleet status</h2>
            </div>
            <div hlmCardContent>
                <div class="grid grid-cols-2 gap-2 text-sm sm:gap-3">
                    <div class="border-border/70 bg-background/40 min-w-0 rounded-md border p-2 sm:p-3">
                        <div class="text-muted-foreground truncate text-xs">Loaded</div>
                        <div class="mt-1 font-semibold tabular-nums">{{ rowLength() }}</div>
                    </div>
                    <div class="border-border/70 bg-background/40 min-w-0 rounded-md border p-2 sm:p-3">
                        <div class="text-muted-foreground truncate text-xs">Status</div>
                        <div class="mt-1 truncate font-semibold">
                            {{ allStarshipsLoaded() ? 'All Loaded' : 'Browsing' }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @if (query.isError()) {
        <div hlmAlert variant="destructive" class="mt-4 sm:mt-6">
            <h4 hlmAlertTitle>Could not load starships</h4>
            <p hlmAlertDescription>{{ query.error().message }}</p>
            <div class="mt-4">
                <button hlmBtn variant="destructive" size="sm" (click)="retryInitialLoad()">
                    Retry
                </button>
            </div>
        </div>
    } @else {
        <div class="mt-4 min-w-0 sm:mt-6">
            <app-table
                [rowData]="rows()"
                (loadMore)="onLoadMore()"
                [isLoading]="isInitialLoading()"
            ></app-table>
        </div>

        @if (allStarshipsLoaded() && rowLength() > 0) {
            <div class="text-muted-foreground mt-3 text-center text-sm">All starships loaded</div>
        }
    }
</section>
