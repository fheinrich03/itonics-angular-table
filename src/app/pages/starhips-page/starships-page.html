<section class="page">
    <div class="page-hero">
        <div class="hero-media hero-media--left" aria-hidden="true">
            <img
                src="/images/milenium-falcon.png"
                alt=""
                class="hero-ship hero-ship--left"
                loading="eager"
                decoding="async"
            />
        </div>

        <div class="min-w-0 self-center">
            <h1 class="page-title">Starships</h1>
            <p class="page-subtitle">
                Search, sort and infinite-scroll through starships from the Star Wars universe.
            </p>
        </div>

        <div class="hero-panel self-end">
            <div class="grid grid-cols-2 gap-3 text-sm">
                <div class="border-border/70 bg-background/40 rounded-md border p-3">
                    <div class="text-muted-foreground text-xs">Loaded</div>
                    <div class="mt-1 font-semibold tabular-nums">{{ rowLength() }}</div>
                </div>
                <div class="border-border/70 bg-background/40 rounded-md border p-3">
                    <div class="text-muted-foreground text-xs">Status</div>
                    <div class="mt-1 font-semibold">
                        {{ allStarshipsLoaded() ? 'All Loaded' : 'Browsing' }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    @if (query.isError()) {
        <div class="card border-destructive/40 bg-destructive/5 text-destructive mt-6">
            <div class="font-semibold">Could not load starships</div>
            <div class="mt-1 text-sm opacity-90">{{ query.error().message }}</div>
            <div class="mt-4">
                <button class="btn-destructive" (click)="retryInitialLoad()">Retry</button>
            </div>
        </div>
    } @else {
        <div class="mt-6">
            <app-table
                [rowData]="rows()"
                (loadMore)="onLoadMore()"
                [isLoading]="isInitialLoading()"
            ></app-table>
        </div>

        @if (allStarshipsLoaded() && rowLength() > 0) {
            <div class="text-muted-foreground mt-3 text-center text-sm">All starships loaded</div>
        }
    }
</section>
